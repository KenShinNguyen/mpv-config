include="~~/profiles.conf"

# ==========    GENERAL    ==========

autofit-larger=100%x100%
prefetch-playlist=yes
force-seekable=yes
keep-open=yes
reset-on-next-file=pause
msg-color=yes                                   # Thêm màu cho console ouput khi xuất ra terminal
msg-module=yes
image-display-duration=inf		                # Không autoplay đối với hình ảnh
hr-seek=yes                                     # Bật khi có thể precise seeks, seeks sẽ không bị giới hạn bởi keyframes

vulkan-async-compute=yes
vulkan-async-transfer=yes
vulkan-queue-count=1
vd-lavc-dr=yes
vulkan-swap-mode=auto 


# ==========    Video Profile    ==========
# This is what profile=gpu-hq do:
# scale=spline36
# cscale=spline36
# dscale=mitchell
# dither-depth=auto
# correct-downscaling=yes
# linear-downscaling=yes
# sigmoid-upscaling=yes
# deband=yes

profile=gpu-hq                                  # Profile có sẵn giúp chất lượng playback của mpv tốt hơn
                                                # Sử dụng các phương thức scale tốt hơn so với mặc định mpv, VLC và MPC
vo=gpu-next                                     # Video output driver sử dụng libplacebo để render. Hỗ trợ gần như đầy đủ các tính năng giống như --vo=gpu
                                                # Nhanh hơn, chất lượng tốt hơn, có thể tonemap DV (P5), HDR10, HDR -> SDR. Tuy nhiên vẫn còn đang thử nghiệm còn một số lỗi
gpu-api=vulkan                                  # hmm vulkan mới, tốt, hiệu năng ổn hơn, tuy nhiên còn nhiều lỗi. Nếu gặp lỗi hãy chỉnh thành d3d11 đối với win và opengl với linux
hwdec=auto-copy
dither-depth=auto  								# Dither bitdepth của video bằng với bitdepth của màn hình
dither=fruit

# ==========    SCALERS AND SHADERS    ==========

scale=ewa_lanczos                               # Luma upscaler
cscale=sinc                      			    # Chroma up & downscaler
cscale-window=blackman
cscale-radius=3
dscale=catmull_rom                              # Luma downscaler
scale-antiring=0.8
dscale-antiring=0.8
cscale-antiring=0.8 

linear-downscaling=no

# ==========    CACHE & STREAMING    ==========
cache=auto                                      # Bật cache hữu dụng khi Playback trước tiếp qua mạng
demuxer-max-bytes=1GiB                          # Giới hạn kích thước dữ liệu cho phép demuxer đọc trước
demuxer-readahead-secs=300                      # Giới hạn thời gian cho phép demuxer đọc trước
demuxer-max-back-bytes=300MiB                   # Giới hạn kích thước dữ liệu demuxer đã đọc qua có thể lưu giữ
ytdl-format=bestvideo+bestaudio/best            # Param chọn source của youtube-dl
hls-bitrate=max                                 # Param chọn source của hls
load-unsafe-playlists=yes

# ==========    DEBANDING    ==========

deband=no                                       # Chỉ nên bật khi video có banding. (Keybind=h)
deband-iterations=4                           	# https://mpv.io/manual/stable/#options-deband-iterations
deband-threshold=54                             # https://mpv.io/manual/stable/#options-deband-threshold
deband-range=17									# https://mpv.io/manual/stable/#options-deband-threshold
deband-grain=26                                 # https://mpv.io/manual/stable/#options-deband-grain

# ==========    ON SCREEN DISPLAY AND ON SCREEN CONTROLLER    ==========

osd-bar=no                                      # Sử dụng seeking/volume box của morden-x
osc=no                                          # Sử dụng UI morden-x thay cho mặc định
border=no                                       # Tắt title bar và border thay vào đó sử dụng của morden X
cursor-autohide=100                             # Trỏ chuột sẽ tử động ẩn sau ms
osd-level=1                                     # https://mpv.io/manual/stable/#options-osd-level
osd-duration=1500                               # Thời gian xuất hiện của OSD messages bằng ms
hr-seek=yes                                     # Bật khi có thể precise seeks, seeks sẽ không bị giới hạn bởi keyframes
                                                # https://mpv.io/manual/stable/#options-hr-seek
# Tuỳ chỉnh style của OSD messages
osd-font="Open Sans"
osd-font-size=40
osd-border-size=2.4      
osd-shadow-offset=0.75           
osd-bold=yes

# ==========    LANGUAGE PRIORITY    ==========

track-auto-selection=yes
alang=ja,jp,jpn,vi,vie,en,eng                   # Thứ tự uy tiên ngôn ngữ của audio
slang=vi,vie                                    # Thứ tự uy tiên ngôn ngữ của subtitles

# ==========    AUDIO    ==========

volume=100                                      # Âm lượng mặc định
audio-file-auto=fuzzy                           # Load source âm thanh bên ngoài có tên gần giống với video
volume-max=200                                  # Dung lượng tối đa cho phép. Qua mức 100 mpv sẽ boost âm lượng từ video nên có thể gây ra suy giảm chất lượng âm thanh.
audio-pitch-correction=yes                      # tự động chèn scaletempo khi phát ở tốc độ cao hơn

# ==========    SUBTITLES    ==========

demuxer-mkv-subtitle-preroll=yes                # https://mpv.io/manual/stable/#options-mkv-subtitle-preroll
sub-ass-vsfilter-blur-compat=no                 # Tương thích ngược với ASS/SSA sử dụng vsfilter
sub-fix-timing=no                               # Do not try to fix gaps (which might make it worse in some cases).
sub-auto=fuzzy                                  # https://mpv.io/manual/stable/#options-no-sub-auto
                                                # Load subtitle bên ngoài có tên gần giống với video
sub-file-paths-append=ass
sub-file-paths-append=srt
sub-file-paths-append=pgs
sub-file-paths-append=vob
sub-file-paths-append=sub
sub-file-paths-append=sup
sub-file-paths-append=subs
sub-file-paths-append=subtitles
# Các tuỳ chọn sau áp dụng với định dạng subtitles không có style riêng (VD: SRT, VTT...)
# Đây là style yêu thích của mình có thể điều chỉnh lại style theo sở thích riêng
sub-font='Open Sans'                            
sub-font-size=45
sub-color='#FFFFFFFF'
sub-border-color="#FF000000"
sub-shadow-color=0.0/0.0/0.0/0.70
sub-border-size=2.4
sub-shadow-offset=0.75
sub-spacing=0.0
sub-bold=yes						     
sub-use-margins=no                              

# ==========    SCREENSHOT    ==========

screenshot-format=png                           # Format của screenshoot
                                                # PNG vẫn được ưu tiên hơn JXL vì tương thích.
screenshot-high-bit-depth=yes                  	# Bitdepth giống với video. Đặt "no" nếu muốn tiết kiệm dung lượng.
screenshot-tag-colorspace=no                    # Tonemap screenshot
screenshot-png-compression=5                    # Tỉ lệ nén của PNG (1-9)
                                                # Giá trị cao thì nén tốt hơn nhưng bù lại tốn thời gian xử lý               
screenshot-directory="~/Pictures/mpv"           # Thư mục chứa screenshot
screenshot-template="%f-%wH.%wM.%wS.%wT-#%#00n" # Định dạng tên (filename-hour-minute-second-milisecond-number)

# ==========    INTERPOLATION    ==========

video-sync=display-resample                      # Player đồng bộ audio và video như thế nào
                                                 # https://mpv.io/manual/master/#options-video-sync
                                                 # (Chỉ hữu dụng khi "interpolation=yes)
interpolation=no                                 # Giảm hiện tượng giật hình do không khớp trong fps của video và refresh rate của màn hình (còn được judder).
                                                 # https://mpv.io/manual/master/#options-interpolation
                                                 # Bật với phím tắt i
# Tuỳ chọn filter cho nội suy temporal axis (frames). 
tscale=sphinx
tscale-blur=0.6991556596428412
tscale-radius=1.05
tscale-clamp=0.0

# ==========   Tone-mapping   ==========
target-colorspace-hint=no                        # Buộc tonemapping HDR -> SDR nếu màn hình của bạn hỗ trợ HDR thì bật lên và bật HDR trong setting của Windows.
hdr-compute-peak=yes
tone-mapping=bt.2446a                            # Cá nhân mình thích bt.2446a hơn các thuật toán khác.
tone-mapping-mode=luma
